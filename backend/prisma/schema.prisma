generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  ADMIN
  CLIENT
  TALENT
}

enum AuthProvider {
  GOOGLE
  LOCAL
}

enum ApplicationType {
  CLIENT_PROJECT
  TALENT
}

enum ApplicationStatus {
  SUBMITTED
  UNDER_REVIEW
  ACCEPTED
  REJECTED
}

model User {
  id           String       @id @default(uuid()) @db.Uuid
  name         String
  email        String       @unique
  role         UserRole
  provider     AuthProvider
  providerId   String?
  avatarUrl    String?
  passwordHash String?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt

  // Relations
  applications Application[]

  @@index([email])
  @@index([role])
}

model Service {
  id               String   @id @default(uuid()) @db.Uuid
  slug             String   @unique
  title            String
  shortDescription String
  longDescription  String
  highlights       String[]
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  // Relations
  projects     Project[]
  applications Application[]

  @@index([slug])
}

model Project {
  id           String   @id @default(uuid()) @db.Uuid
  title        String
  slug         String   @unique
  serviceId    String   @db.Uuid
  thumbnailUrl String
  imageUrls    String[]
  summary      String
  caseStudy    String
  isFeatured   Boolean  @default(false)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  // Relations
  service      Service       @relation(fields: [serviceId], references: [id])
  testimonials Testimonial[]

  @@index([serviceId])
  @@index([isFeatured])
}

model Testimonial {
  id         String  @id @default(uuid()) @db.Uuid
  clientName String
  clientRole String
  quote      String
  projectId  String? @db.Uuid

  createdAt DateTime @default(now())

  // Relations
  project Project? @relation(fields: [projectId], references: [id])

  @@index([projectId])
  @@index([createdAt])
}

model Application {
  id         String            @id @default(uuid()) @db.Uuid
  type       ApplicationType
  serviceId  String?           @db.Uuid
  name       String
  email      String
  message    String
  budget     Float?
  experience String?
  status     ApplicationStatus @default(SUBMITTED)
  createdAt  DateTime          @default(now())

  // Relations
  service Service? @relation(fields: [serviceId], references: [id])
  user    User?    @relation(fields: [userId], references: [id])
  userId  String?  @db.Uuid

  @@index([serviceId])
  @@index([email])
  @@index([status])
  @@index([type])
}
